<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>图.html</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="SynEdit HTML exporter" />
<style type="text/css">
<!--
body { color: #000000; background-color: #FFFFFF; }
.cpp1-assembler { color: #0000FF; }
.cpp1-character { color: #000000; }
.cpp1-comment { color: #0078D7; font-style: italic; }
.cpp1-float { color: #800080; }
.cpp1-hexadecimal { color: #800080; }
.cpp1-identifier { color: #000000; }
.cpp1-illegalchar { color: #000000; }
.cpp1-number { color: #800080; }
.cpp1-octal { color: #800080; }
.cpp1-preprocessor { color: #008000; }
.cpp1-reservedword { color: #000000; font-weight: bold; }
.cpp1-space { background-color: #FFFFFF; color: #000000; }
.cpp1-string { color: #0000FF; font-weight: bold; }
.cpp1-symbol { color: #FF0000; font-weight: bold; }
-->
</style>
</head>
<body>
<pre>
<code><span style="font: 21pt Consolas;">
<span class="cpp1-illegalchar">双向邻接表 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#gr01</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> addedge</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	to</span><span class="cpp1-symbol">[++</span><span class="cpp1-identifier">E</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">E</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> E</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	to</span><span class="cpp1-symbol">[++</span><span class="cpp1-identifier">E</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">E</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> E</span><span class="cpp1-symbol">;
}
</span><span class="cpp1-illegalchar">有向图的强连通分量 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#gr02</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> dfs</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">cnt</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> instack</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> sta</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">stc</span><span class="cpp1-symbol">++]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> to</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]])
</span><span class="cpp1-space">			dfs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> down</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">else</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">instack</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">			down</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">)
</span><span class="cpp1-space">			y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> sta</span><span class="cpp1-symbol">[--</span><span class="cpp1-identifier">stc</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> instack</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> top</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">;
}
</span><span class="cpp1-illegalchar">有向无环图的拓扑排序 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#gr03</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> toposort</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> h</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> t </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> V</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">deg</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">t</span><span class="cpp1-symbol">++]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">h </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> h </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> t</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">h</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">h</span><span class="cpp1-symbol">]];</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!--</span><span class="cpp1-identifier">deg</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> to</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]])</span><span class="cpp1-space"> que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">t</span><span class="cpp1-symbol">++]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">;
}
</span><span class="cpp1-illegalchar">无向图的桥边 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#gr04</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> dfs</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> px </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">cnt</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> to</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">			dfs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> down</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]);
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-comment">// edge i is a bridge
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">else</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">px </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">			down</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]);
}
</span><span class="cpp1-illegalchar">无向图的割点 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#gr05</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> dfs</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> px </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> c </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> is_cut </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">cnt</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> to</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">			dfs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> down</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]),</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> is_cut </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">else</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">px </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">			down</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">px</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> is_cut </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> c </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;
}
</span><span class="cpp1-illegalchar">无向图的边双缩点 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#gr06</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> dfs</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> px </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">cnt</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> stack</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">stc</span><span class="cpp1-symbol">++]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> to</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">			dfs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> down</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]);
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> bridge</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">ad</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> bridge</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">else</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">px </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">			down</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">)
</span><span class="cpp1-space">			y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> stack</span><span class="cpp1-symbol">[--</span><span class="cpp1-identifier">stc</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> top</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">;
}
</span><span class="cpp1-illegalchar">无向图的点双缩点 </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> 圆方树 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#gr07</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> dfs</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> px </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> z</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">cnt</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> stack</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">top</span><span class="cpp1-symbol">++]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> to</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">			dfs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> down</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]);
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">link</span><span class="cpp1-symbol">(++</span><span class="cpp1-identifier">bcc_cnt </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> V</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> z </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> z </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">)
</span><span class="cpp1-space">					link</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">z </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> stack</span><span class="cpp1-symbol">[--</span><span class="cpp1-identifier">top</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> bcc_cnt </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> V</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">else</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">px </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">			down</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">low</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]);
}
</span><span class="cpp1-illegalchar">带权 edge 结构体 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#gr08</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">struct</span><span class="cpp1-space"> edge </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> w</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	edge </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> u0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> v0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> w0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> w</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">w0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{}
};
</span><span class="cpp1-illegalchar">单源最短路 </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">Dijkstra</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#gr09</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">typedef</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">pair </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-reservedword">int</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> pr</span><span class="cpp1-symbol">;

</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> d</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">];
</span><span class="cpp1-identifier">std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">priority_queue </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">pr</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">vector </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">pr</span><span class="cpp1-symbol">&gt;,</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">greater </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">pr</span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> pq</span><span class="cpp1-symbol">;

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> Dijkstra</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> s</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> D</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	memset</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">d</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">63</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">V </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">pq</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">emplace</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">d</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">s</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> s</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!</span><span class="cpp1-identifier">pq</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">empty</span><span class="cpp1-symbol">();</span><span class="cpp1-space"> </span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">tie</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">D</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> pq</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">top</span><span class="cpp1-symbol">(),</span><span class="cpp1-space"> pq</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">pop</span><span class="cpp1-symbol">();
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">d</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> D</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">continue</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">D </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">w </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> d</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">				pq</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">emplace</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">d</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> D </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">w</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}
</span><span class="cpp1-illegalchar">所有点对的最短路 </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">Floyd</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#gr10</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> Floyd</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">k </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> k </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> V</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> V</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> V</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">				down</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">d</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> d</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> d</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]);
}
</span><span class="cpp1-illegalchar">最小生成树 </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">Kruskal</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#gr11</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">struct</span><span class="cpp1-space"> edge </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> w</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	edge </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> u0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> v0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> w0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">):</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> w</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">w0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> edge </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">b</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> w </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">w</span><span class="cpp1-symbol">;}
};

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> Kruskal</span><span class="cpp1-symbol">(){
</span><span class="cpp1-space">	uf</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">resize</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">V</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	sort</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">e </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> e </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">E </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">));
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> E</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">++)
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">uf</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">test</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">)){
</span><span class="cpp1-space">			</span><span class="cpp1-comment">// e is an edge of minimum spanning tree
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(++</span><span class="cpp1-identifier">Es </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> V </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}
}
</span><span class="cpp1-illegalchar">网络流 edge 结构体 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#gr12</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">struct</span><span class="cpp1-space"> edge </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-comment">// f is remaining flow
</span><span class="cpp1-space">	edge</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> u0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> v0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> f0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">):</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">f0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{}
};
</span><span class="cpp1-illegalchar">最大流 </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">Dinic</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#gr13</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> Flow </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-preprocessor">#define ad(x) ((x - 1 ^ 1) + 1)

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> N </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">2000</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> M </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">100000</span><span class="cpp1-symbol">;

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">struct</span><span class="cpp1-space"> edge </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		edge </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> u0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> v0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> f0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">f0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{}
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">M</span><span class="cpp1-symbol">];

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> V </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> E </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> si </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> ti </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> flow</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">M</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> cur</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">];

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> addedge</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		e</span><span class="cpp1-symbol">[++</span><span class="cpp1-identifier">E</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> edge</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">E</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> E</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		e</span><span class="cpp1-symbol">[++</span><span class="cpp1-identifier">E</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> edge</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">E</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> E</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> bfs</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> h</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> t </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		memset</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">dep</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">sizeof</span><span class="cpp1-space"> dep</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		que</span><span class="cpp1-symbol">[</span><span class="cpp1-number">0</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> si</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">si</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">h </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> h </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> t</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">h</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">((</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">h</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> ti</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">f</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">					que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">t</span><span class="cpp1-symbol">++]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> dfs</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> lim</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> a</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> f </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> ti </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!</span><span class="cpp1-identifier">lim</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> lim</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> cur</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">f</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">				a </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">min</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">lim </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">f</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">				c </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> dfs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> a</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">				e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">f </span><span class="cpp1-symbol">-=</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">ad</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)].</span><span class="cpp1-identifier">f </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">((</span><span class="cpp1-identifier">f </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> lim</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> Dinic</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">flow </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> bfs</span><span class="cpp1-symbol">();</span><span class="cpp1-space"> flow </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> dfs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">si</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> INT_MAX</span><span class="cpp1-symbol">))
</span><span class="cpp1-space">			memcpy</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">cur</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">sizeof</span><span class="cpp1-space"> cur</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> flow</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}
</span><span class="cpp1-illegalchar">最小费用最大流 </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">Dinic</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#gr14</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> CF </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-preprocessor">#define ad(x) ((x - 1 ^ 1) + 1)

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> N </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">2000</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> M </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">100000</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> INF </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x7f7f7f7f</span><span class="cpp1-symbol">;

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">struct</span><span class="cpp1-space"> edge </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		edge </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> u0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> v0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> c0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> f0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">c0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">f0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{}
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">M</span><span class="cpp1-symbol">];

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> V </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> E </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> si </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> ti </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> flow</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> cost</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">M</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> cur</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">M </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> in_que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> used</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">];

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> addedge</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		e</span><span class="cpp1-symbol">[++</span><span class="cpp1-identifier">E</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> edge</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">E</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> E</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		e</span><span class="cpp1-symbol">[++</span><span class="cpp1-identifier">E</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> edge</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">E</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> E</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> bfs</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> h </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> M</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> t </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> h </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		memset</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">dep</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">127</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">sizeof</span><span class="cpp1-space"> dep</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">h</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> ti</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">ti</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> in_que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">ti</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> h </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> t</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">			x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">h</span><span class="cpp1-symbol">++],</span><span class="cpp1-space"> in_que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">c </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">ad</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)].</span><span class="cpp1-identifier">f</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">					dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">					</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">in_que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">						in_que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">h</span><span class="cpp1-symbol">]]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">t</span><span class="cpp1-symbol">++]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> que</span><span class="cpp1-symbol">[--</span><span class="cpp1-identifier">h</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">				</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">si</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> INF</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> dfs</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> lim</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> a</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> f </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> ti </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!</span><span class="cpp1-identifier">lim</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> lim</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		used</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> cur</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">c </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">f </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!</span><span class="cpp1-identifier">used</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">				a </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">min</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">lim </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">f</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">				c </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> dfs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> a</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">				e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">f </span><span class="cpp1-symbol">-=</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">ad</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)].</span><span class="cpp1-identifier">f </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">((</span><span class="cpp1-identifier">f </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> lim</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> Dinic</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">cost </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> flow </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> bfs</span><span class="cpp1-symbol">();</span><span class="cpp1-space"> </span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">			memcpy</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">cur</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">sizeof</span><span class="cpp1-space"> cur</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">			memset</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">used</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">sizeof</span><span class="cpp1-space"> used</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">			flow </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> f </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> dfs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">si</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> INF</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">			cost </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> dep</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">si</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> cost</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}
</span><span class="cpp1-illegalchar">二分图最大匹配 </span><span class="cpp1-symbol">(</span><span class="cpp1-illegalchar">增广路算法</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#gr15</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> dfs</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">){
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n_g</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">++)
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!</span><span class="cpp1-identifier">used</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]){
</span><span class="cpp1-space">			used</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">boy</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> dfs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">boy</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])){
</span><span class="cpp1-space">				boy</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> girl</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">;
}
</span><span class="cpp1-illegalchar">一般图最大匹配 </span><span class="cpp1-symbol">(</span><span class="cpp1-illegalchar">带花树算法</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#gr16</span><span class="cpp1-symbol">]:

</span><span class="cpp1-preprocessor">#define unknown -1
#define boy 0
#define girl 1

</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> LCA</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(++</span><span class="cpp1-identifier">hash_cnt</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> swap</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">)</span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> ancestor</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">hash</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> hash_cnt</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-comment">// visited
</span><span class="cpp1-space">		hash</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> hash_cnt</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> prev</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">match</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]];
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x131a371</span><span class="cpp1-symbol">;
}

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> blossom</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> root</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">t</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-space"> </span><span class="cpp1-comment">// vertices in blossoms are all boys !
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> z</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> ancestor</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> root</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> z</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> prev</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		prev</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> z </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> match</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">col</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">z</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> girl</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">t</span><span class="cpp1-symbol">++]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> z</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> col</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">z</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> boy</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ancestor</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> root</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ancestor</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">z</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> z</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">z</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> root</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}

</span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> bfs</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> st</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> h</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> t </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> g</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	que</span><span class="cpp1-symbol">[</span><span class="cpp1-number">0</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> st</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> col</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">st</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> boy</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">h </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> h </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> t</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">h</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">h</span><span class="cpp1-symbol">]];</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">col</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> to</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> unknown</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-space"> </span><span class="cpp1-comment">// common step
</span><span class="cpp1-space">				prev</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> col</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> girl</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">match</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-space"> </span><span class="cpp1-comment">// augment (change mates) !!!
</span><span class="cpp1-space">					</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">g </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> g</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> swap</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">match</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">b</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> g</span><span class="cpp1-symbol">))
</span><span class="cpp1-space">						match</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">g</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> b </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> prev</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">g</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">					</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">				</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">				col</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">t</span><span class="cpp1-symbol">++]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> match</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> boy</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-symbol">}</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">else</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">col</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> boy </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> ancestor</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> ancestor</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-space"> </span><span class="cpp1-comment">// flower !!!
</span><span class="cpp1-space">				b </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> LCA</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> blossom</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> t</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> blossom</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> t</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">			</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">;
}

</span><span class="cpp1-comment">// main process
</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> V</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> v </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> V</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> col</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> unknown</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">match</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> bfs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">ans</span><span class="cpp1-symbol">;
}
</span><span class="cpp1-illegalchar">最小树形图 </span><span class="cpp1-symbol">(</span><span class="cpp1-illegalchar">朱</span><span class="cpp1-symbol">-</span><span class="cpp1-illegalchar">刘</span><span class="cpp1-symbol">-</span><span class="cpp1-identifier">Edmonds</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#gr17</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> DMST </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> N </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">108</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> M </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">10054</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> INF </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x3f3f3f3f</span><span class="cpp1-symbol">;

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> V</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> E</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> r</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> best</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> bel</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> used</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> cyc</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> min</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> delta</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">M</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> ans</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">M</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	edge e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">M</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	pr elim</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> M</span><span class="cpp1-symbol">];

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> reset</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> root</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">V </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> E </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> r </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> root</span><span class="cpp1-symbol">;}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> link</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> w</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">E</span><span class="cpp1-symbol">++]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> edge</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> w</span><span class="cpp1-symbol">);}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> CLE</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> w</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> r</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> cnt</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> tot </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> w0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> w1 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		n </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> V</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> r </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> DMST</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">r</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">iota</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">bel</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> bel </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">V </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		memset</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ans</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> E</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> memset</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">delta</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> E </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">;</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> cnt</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> r </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> cyc</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">r</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">			memset</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">min</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">63</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">V </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">),
</span><span class="cpp1-space">			memset</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">used</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">V </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> used</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">r</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			memset</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">cyc</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> cnt </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">V </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> E</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">				u </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> bel</span><span class="cpp1-symbol">[</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">u </span><span class="cpp1-symbol">],</span><span class="cpp1-space"> v </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> bel</span><span class="cpp1-symbol">[</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">v </span><span class="cpp1-symbol">],</span><span class="cpp1-space"> w </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">w </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> delta</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> v </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> w </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> min</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> min</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> w</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> best</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> r</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">min</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> INF</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!(</span><span class="cpp1-identifier">u </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> r </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> used</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">]);</span><span class="cpp1-space"> u </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> used</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">used</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">					</span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">cnt</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">					</span><span class="cpp1-reservedword">do</span><span class="cpp1-space"> cyc</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> cnt</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">while</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">				</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">			</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!(</span><span class="cpp1-identifier">w </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> cnt</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">break</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">cyc</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> ans</span><span class="cpp1-symbol">[</span><span class="cpp1-space"> best</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">else</span><span class="cpp1-space"> cyc</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">cnt</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> E</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">				u </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> bel</span><span class="cpp1-symbol">[</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">u </span><span class="cpp1-symbol">],</span><span class="cpp1-space"> v </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> bel</span><span class="cpp1-symbol">[</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">v </span><span class="cpp1-symbol">];
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">cyc</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> cyc</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">])
</span><span class="cpp1-space">					</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">delta</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> min</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> cyc</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> w</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">						elim</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">tot</span><span class="cpp1-symbol">++]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> pr</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">best</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">			</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> V</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> bel</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> cyc</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">bel</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]];
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> r</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> ans</span><span class="cpp1-symbol">[</span><span class="cpp1-space"> best</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> tot </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">--</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ans</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">elim</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">second</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> ans</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">elim</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">first</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> E</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ans</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">w0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> w1 </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">w</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> assert</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">w0 </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> V </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> w1</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}

</span></span>
</code></pre>
</body>
</html>