<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>数论.html</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="SynEdit HTML exporter" />
<style type="text/css">
<!--
body { color: #000000; background-color: #FFFFFF; }
.cpp1-assembler { color: #0000FF; }
.cpp1-character { color: #000000; }
.cpp1-comment { color: #0078D7; font-style: italic; }
.cpp1-float { color: #800080; }
.cpp1-hexadecimal { color: #800080; }
.cpp1-identifier { color: #000000; }
.cpp1-illegalchar { color: #000000; }
.cpp1-number { color: #800080; }
.cpp1-octal { color: #800080; }
.cpp1-preprocessor { color: #008000; }
.cpp1-reservedword { color: #000000; font-weight: bold; }
.cpp1-space { background-color: #FFFFFF; color: #000000; }
.cpp1-string { color: #0000FF; font-weight: bold; }
.cpp1-symbol { color: #FF0000; font-weight: bold; }
-->
</style>
</head>
<body>
<pre>
<code><span style="font: 21pt Consolas;"><span class="cpp1-illegalchar">最大公约数 </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">gcd</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#nt01</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> gcd</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> a</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> b </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> gcd</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">b</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> a </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> a</span><span class="cpp1-symbol">;}
</span><span class="cpp1-illegalchar">快速幂 </span><span class="cpp1-symbol">(</span><span class="cpp1-illegalchar">递归版本</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#nt02</span><span class="cpp1-symbol">]:

</span><span class="cpp1-identifier">ll PowerMod</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll a</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> ll n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> ll m </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> a </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-number">1ll</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	ll s </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> PowerMod</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">a</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	s </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> s </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> s </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> s </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> a </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> m </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> s</span><span class="cpp1-symbol">;
}
</span><span class="cpp1-illegalchar">快速幂 </span><span class="cpp1-symbol">(</span><span class="cpp1-illegalchar">非递归版本</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#nt03</span><span class="cpp1-symbol">]:

</span><span class="cpp1-identifier">ll PowerMod</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll a</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> ll c </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">&gt;&gt;=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> a </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> a </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> a </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> c </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> c </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> a </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">;}
</span><span class="cpp1-illegalchar">扩展 Euclid 算法 </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">exgcd</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#nt04</span><span class="cpp1-symbol">]:

</span><span class="cpp1-identifier">ll exgcd</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll a</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> ll b</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> ll </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> ll </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">b</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">ll d </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> exgcd</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">b</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> a </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">-=</span><span class="cpp1-space"> a </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> b </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> d</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">else</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> a</span><span class="cpp1-symbol">;
}
</span><span class="cpp1-illegalchar">基本预处理 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#nt05</span><span class="cpp1-symbol">]:

</span><span class="cpp1-comment">// factorials, fact-inverses, unbounded
</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> init</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(*</span><span class="cpp1-identifier">fact </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> N</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> fact</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll</span><span class="cpp1-symbol">)</span><span class="cpp1-identifier">fact</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">--</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> finv</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> PowerMod</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">fact</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> mod </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">--</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> finv</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll</span><span class="cpp1-symbol">)</span><span class="cpp1-identifier">finv</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;
}

</span><span class="cpp1-comment">// factorials, fact-inverses, bounded
</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> init</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(*</span><span class="cpp1-identifier">fact </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> fact</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll</span><span class="cpp1-symbol">)</span><span class="cpp1-identifier">fact</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	finv</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">n</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> PowerMod</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">fact</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">n</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> mod </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">--</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> finv</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll</span><span class="cpp1-symbol">)</span><span class="cpp1-identifier">finv</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;
}

</span><span class="cpp1-comment">// inverses, factorials, fact-inverses, unbounded
</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> init</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">inv</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> N</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> inv</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> ll</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">mod </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> mod </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> inv</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">mod </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(*</span><span class="cpp1-identifier">finv </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">fact </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> N</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> fact</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll</span><span class="cpp1-symbol">)</span><span class="cpp1-identifier">fact</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> finv</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll</span><span class="cpp1-symbol">)</span><span class="cpp1-identifier">finv</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> inv</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;
}

</span><span class="cpp1-comment">// inverses, factorials, fact-inverses, bounded
</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> init</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">inv</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> inv</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> ll</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">mod </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> mod </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> inv</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">mod </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(*</span><span class="cpp1-identifier">finv </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">fact </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> fact</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll</span><span class="cpp1-symbol">)</span><span class="cpp1-identifier">fact</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> finv</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll</span><span class="cpp1-symbol">)</span><span class="cpp1-identifier">finv</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> inv</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;
}
</span><span class="cpp1-illegalchar">线性筛素数 </span><span class="cpp1-symbol">(</span><span class="cpp1-illegalchar">筛最小素因子</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#nt06</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> pn </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-number">78540</span><span class="cpp1-symbol">];

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> sieve</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	memset</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">sizeof</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!~</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">pn</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> pn</span><span class="cpp1-symbol">++;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}
</span><span class="cpp1-identifier">Miller</span><span class="cpp1-symbol">-</span><span class="cpp1-identifier">Rabin 素数测试 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#nt07</span><span class="cpp1-symbol">]:

</span><span class="cpp1-comment">// No pseudoprime below 2^64 to base 2, 3, 5, 7, 11, 13, 82, 373.
</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> test</span><span class="cpp1-symbol">[</span><span class="cpp1-number">8</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-number">2</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">3</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">5</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">7</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">11</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">13</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">82</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">373</span><span class="cpp1-symbol">};
</span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> Miller_Rabin</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll n</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> MAX</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">n</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> ll s </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">c </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!(</span><span class="cpp1-identifier">s </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> s </span><span class="cpp1-symbol">&gt;&gt;=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">8</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> test</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]))</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		u </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> PowerMod</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">test</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> s</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> u </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> MulMod</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> u </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> u </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> v </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">;
}
</span><span class="cpp1-illegalchar">分解质因数 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#nt08</span><span class="cpp1-symbol">]:

</span><span class="cpp1-comment">// version 1
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> push</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll prime</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> alpha</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">pr</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">cnt</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> prime</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> al</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">cnt</span><span class="cpp1-symbol">++]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> alpha</span><span class="cpp1-symbol">;}

</span><span class="cpp1-comment">// version 2
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> push</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll prime</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> alpha</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	map</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">iterator it </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> result</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">find</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">prime</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	it </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> result</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">end</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">)</span><span class="cpp1-identifier">result</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">emplace</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">prime</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> alpha</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">)(</span><span class="cpp1-identifier">it</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">second </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> alpha</span><span class="cpp1-symbol">);
}

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> factor</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll n</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> cnt </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-comment">// result.clear();
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> N</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll</span><span class="cpp1-symbol">)</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> push</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">else</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">n</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]);</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">/=</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> push</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}
</span><span class="cpp1-illegalchar">线性筛 Euler φ 函数 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#nt09</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> sieve</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> phi</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	memset</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">sizeof</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!~</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">pn</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> pn</span><span class="cpp1-symbol">++,</span><span class="cpp1-space"> phi</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> phi</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> phi</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> phi</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> phi</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}
</span><span class="cpp1-illegalchar">线性筛 Möbius μ 函数 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#nt10</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> sieve</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> mu</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	memset</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">sizeof</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!~</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">pn</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> pn</span><span class="cpp1-symbol">++,</span><span class="cpp1-space"> mu</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> mu</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-identifier">mu</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}
</span><span class="cpp1-illegalchar">遍历 ⌊n </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> i⌋ 的所有可能值 </span><span class="cpp1-symbol">(</span><span class="cpp1-illegalchar">旧版整除分块</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#nt11</span><span class="cpp1-symbol">]:

</span><span class="cpp1-preprocessor">#define next(n, i) (n / (n / i + 1))
</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">){
</span><span class="cpp1-space">	j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-comment">// do something
</span><span class="cpp1-symbol">}

</span><span class="cpp1-preprocessor">#define _next(n, i) (n / (n / (i + 1)))
</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">){
</span><span class="cpp1-space">	j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> _next</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-comment">// do something
</span><span class="cpp1-symbol">}

</span><span class="cpp1-comment">// 0 1 100 1 2 50 2 3 33 3 4 25 4 5 20 5 6 16 16 6 7 14 7 8 12 8 9 11 9 10 10 10 11 9 11 12 8 12 13 7 14 15 6 16 17 5 20 21 4 25 26 3 33 34 2 50 51 1 100 101 0 ?
</span><span class="cpp1-illegalchar">新版整除分块 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#nt12</span><span class="cpp1-symbol">]:

</span><span class="cpp1-comment">// int32 ver.
</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> cnt</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> srn</span><span class="cpp1-symbol">;
</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">G</span><span class="cpp1-symbol">];

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> ID</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> srn </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> cnt </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">;}

{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	srn </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> sqrt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> cnt </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> srn </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">srn </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">srn </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> srn</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">cnt </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
}

</span><span class="cpp1-comment">// int64 ver.
</span><span class="cpp1-identifier">ll n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">G</span><span class="cpp1-symbol">];
</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> cnt</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> srn</span><span class="cpp1-symbol">;

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> ID</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> srn </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> cnt </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">;}

{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	srn </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> sqrt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> cnt </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> srn </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">srn </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">srn </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1ll</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> srn</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">cnt </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
}
</span><span class="cpp1-illegalchar">杜氏求和法 </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> 杜教筛 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#nt13</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> Dsum</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> sq</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> _</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> cnt </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> N</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> Mu</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> smu</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]],</span><span class="cpp1-space"> Phi</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> sphi</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]];
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> cnt</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">m </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> Mu</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> ll </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">p </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> Phi</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">		n </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> sq </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> sqrt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> m </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> p </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1ll</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> l </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">sq </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> sq</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">--</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">			_ </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">k </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> m </span><span class="cpp1-symbol">-=</span><span class="cpp1-space"> _ </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> smu</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> p </span><span class="cpp1-symbol">-=</span><span class="cpp1-space"> _ </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> sphi</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> l </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> k </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> sq</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> m </span><span class="cpp1-symbol">-=</span><span class="cpp1-space"> Mu</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">_ </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> ID</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">)],</span><span class="cpp1-space"> p </span><span class="cpp1-symbol">-=</span><span class="cpp1-space"> Phi</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">_</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}
</span><span class="cpp1-illegalchar">大小步离散对数 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#nt14</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> Boy_Step_Girl_Step</span><span class="cpp1-symbol">(){
</span><span class="cpp1-space">	mii </span><span class="cpp1-symbol">::</span><span class="cpp1-space"> iterator it</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	ll boy </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> girl </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> t</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">++){
</span><span class="cpp1-space">		m</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">insert</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">pr</span><span class="cpp1-symbol">((</span><span class="cpp1-reservedword">int</span><span class="cpp1-symbol">)</span><span class="cpp1-identifier">boy</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">));</span><span class="cpp1-space"> </span><span class="cpp1-comment">// if there exists in map, then ignore it
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">boy </span><span class="cpp1-symbol">*=</span><span class="cpp1-space"> a</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%=</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">++){
</span><span class="cpp1-space">		t </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> b </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> inv</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">girl</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		it </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">find</span><span class="cpp1-symbol">((</span><span class="cpp1-reservedword">int</span><span class="cpp1-symbol">)</span><span class="cpp1-identifier">t</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">it </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">end</span><span class="cpp1-symbol">())
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> it</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">second</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">girl </span><span class="cpp1-symbol">*=</span><span class="cpp1-space"> boy</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%=</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">;
}

</span><span class="cpp1-comment">// input p and then B = (int)sqrt(p - 1);
// inv(x) is the multiplicative inverse of x in Z[p].
// mii: map &lt;int, int&gt; and m is a variable of which.
</span><span class="cpp1-identifier">Pollard</span><span class="cpp1-symbol">-</span><span class="cpp1-identifier">Rho 素因数分解 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#nt15</span><span class="cpp1-symbol">]:

</span><span class="cpp1-identifier">ll Pollard_Rho</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	ll i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> k </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> rand</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> k </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> </span><span class="cpp1-number">131072</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">MulMod</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		p </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> gcd</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">ll</span><span class="cpp1-symbol">&gt;((</span><span class="cpp1-identifier">ull</span><span class="cpp1-symbol">)(</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> p </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(++</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> k </span><span class="cpp1-symbol">&lt;&lt;=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;
}

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> push</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll prime</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> alpha</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	map</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">iterator it </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> result</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">find</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">prime</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	it </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> result</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">end</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">)</span><span class="cpp1-identifier">result</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">insert</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">pr</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">prime</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> alpha</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">)(</span><span class="cpp1-identifier">it</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">second </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> alpha</span><span class="cpp1-symbol">);
}

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> factor</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll n</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> ll p</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">)
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> MAX</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">Miller_Rabin</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">push</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">k </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">97</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!(</span><span class="cpp1-identifier">p </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> Pollard_Rho</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">));</span><span class="cpp1-space"> </span><span class="cpp1-symbol">--</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">			factor</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">/=</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">else</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">			i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">n</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">n</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">/=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">			push</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}
}

</span></span>
</code></pre>
</body>
</html>