<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>常用.html</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="SynEdit HTML exporter" />
<style type="text/css">
<!--
body { color: #000000; background-color: #FFFFFF; }
.cpp1-assembler { color: #0000FF; }
.cpp1-character { color: #000000; }
.cpp1-comment { color: #0078D7; font-style: italic; }
.cpp1-float { color: #800080; }
.cpp1-hexadecimal { color: #800080; }
.cpp1-identifier { color: #000000; }
.cpp1-illegalchar { color: #000000; }
.cpp1-number { color: #800080; }
.cpp1-octal { color: #800080; }
.cpp1-preprocessor { color: #008000; }
.cpp1-reservedword { color: #000000; font-weight: bold; }
.cpp1-space { background-color: #FFFFFF; color: #000000; }
.cpp1-string { color: #0000FF; font-weight: bold; }
.cpp1-symbol { color: #FF0000; font-weight: bold; }
-->
</style>
</head>
<body>
<pre>
<code><span style="font: 21pt Consolas;"><span class="cpp1-identifier">IO 优化 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#ed01</span><span class="cpp1-symbol">]:

</span><span class="cpp1-preprocessor">#define ID isdigit(c = *next++)
#define IS isspace(c = *next++)

</span><span class="cpp1-reservedword">struct</span><span class="cpp1-space"> Istream </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">char</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">next</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> buf</span><span class="cpp1-symbol">[</span><span class="cpp1-number">20030731</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	Istream </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> init</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">FILE </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">f </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> stdin</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">fread</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">buf</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">sizeof</span><span class="cpp1-space"> buf</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> next </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> buf</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	Istream </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!</span><span class="cpp1-identifier">ID</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!~</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> c </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-number">15</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> ID</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-number">10</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">c </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-number">15</span><span class="cpp1-symbol">));
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	Istream </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">char</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> IS</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!~</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(*</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">++</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!</span><span class="cpp1-identifier">IS</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">++</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!~</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">break</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">char</span><span class="cpp1-space"> get</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">next</span><span class="cpp1-symbol">++;}
}</span><span class="cpp1-space"> cin</span><span class="cpp1-symbol">;

</span><span class="cpp1-reservedword">struct</span><span class="cpp1-space"> Ostream </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">char</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">next</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> buf</span><span class="cpp1-symbol">[</span><span class="cpp1-number">20030731</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> _buf</span><span class="cpp1-symbol">[</span><span class="cpp1-number">34</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	Ostream </span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">next </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> buf</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> flush</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">FILE </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">f </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> stdout</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">fwrite</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">buf</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> next </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> buf</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> next </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> buf</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	Ostream </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> put</span><span class="cpp1-symbol">(</span><span class="cpp1-number">48</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">/=</span><span class="cpp1-space"> </span><span class="cpp1-number">10</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> _buf</span><span class="cpp1-symbol">[++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> </span><span class="cpp1-number">10</span><span class="cpp1-space"> </span><span class="cpp1-symbol">|</span><span class="cpp1-space"> </span><span class="cpp1-number">48</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">--</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> put</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">_buf</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	Ostream </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">char</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> put</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	Ostream </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">char</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">s</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">char</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">p </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">char</span><span class="cpp1-symbol">*)</span><span class="cpp1-identifier">s</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> put</span><span class="cpp1-symbol">(*</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> put</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">char</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{*</span><span class="cpp1-identifier">next</span><span class="cpp1-symbol">++</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">;}
}</span><span class="cpp1-space"> cout</span><span class="cpp1-symbol">;
</span><span class="cpp1-illegalchar">动态规划的转移 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#ed02</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> up</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;}
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> down</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;}
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> min</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">;}
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> max</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">;}
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> reduce</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">31</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;}
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> add</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">31</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;}
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> sub</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">-=</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">31</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;}
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> half</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(-(</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> iv2</span><span class="cpp1-symbol">);}
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> neg</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">mod </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">);}

</span><span class="cpp1-comment">// another ver.
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> up</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;}
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> down</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;}
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> add</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">31</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;}
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> sub</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">-=</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">31</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;}

</span><span class="cpp1-comment">// templated ver.
</span><span class="cpp1-preprocessor">#define templated template &lt;typename T&gt;
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> up</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">T </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> T y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;}
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> down</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">T </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> T y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;}
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> T min</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> T x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> T y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">;}
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> T max</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> T x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> T y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">;}
</span><span class="cpp1-illegalchar">乘模函数 </span><span class="cpp1-symbol">(</span><span class="cpp1-number">64</span><span class="cpp1-space"> bit 大整数相乘取模</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#ed03</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> ll MulMod</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll a</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> ll b</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> ll m</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	ll t </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">a </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> b </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll</span><span class="cpp1-symbol">)((</span><span class="cpp1-identifier">ld</span><span class="cpp1-symbol">)</span><span class="cpp1-identifier">a </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> b </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> t </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">t </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">63</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">);
}
</span><span class="cpp1-identifier">ST 表 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#ed04</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> RMQ_simple </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> build_sparse_table</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">f</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">g </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">st</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> k </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">			f </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> g</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> g </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> st</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> k </span><span class="cpp1-symbol">-=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">				g</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> min</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">f</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">)]);
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> range</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> L</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> R</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> c </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> lg2</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">R </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> L</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> min</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">st</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">L</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> st</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">R </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">)]);
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}

</span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> RMQ_fake </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> LN </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">18</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> TH </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">18</span><span class="cpp1-symbol">;

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">a</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> pre</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> suf</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> bel</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> L</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> st</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">LN</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">N </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> TH</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">lay </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">st</span><span class="cpp1-symbol">;

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> build</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n_</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">a_</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> I</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">f</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">g </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> lay</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> n_</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> a </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> a_</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">I </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> I </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> I </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> TH</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">			pre</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">I</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> a</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">I</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> bel</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">I</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> TH </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> I </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> pre</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">I </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> min</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">pre</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">I </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> a</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">I </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">]),</span><span class="cpp1-space"> bel</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">I </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(--</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> suf</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">I </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> a</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">I </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> </span><span class="cpp1-symbol">--</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> suf</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">I </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> min</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">suf</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">I </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> a</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">I </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">]));
</span><span class="cpp1-space">			lay</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> suf</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">I</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">k </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> L </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> L</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">f </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> g</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> g </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> st</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> k </span><span class="cpp1-symbol">-=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">				g</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> min</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">f</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">)]);
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> range</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> L</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> R</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">R </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> L </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> TH</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">min_element</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">a </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> L</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> a </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> R</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> bel</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">L</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> bel</span><span class="cpp1-symbol">[--</span><span class="cpp1-identifier">R</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> c </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> lg2</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> min</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">min</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">suf</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">L</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> pre</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">R</span><span class="cpp1-symbol">]),</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> min</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">st</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> st</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">)])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> INT_MAX</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}
</span><span class="cpp1-illegalchar">离散化 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#ed05</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> DC </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> F</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> pr D</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">];

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> Discretize</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> cnt </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">sort</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">D</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> D </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">			F</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">D</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">second</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> D</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">first </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> D</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">first </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> cnt </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">D</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">cnt</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> D</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> cnt</span><span class="cpp1-symbol">++));
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> cnt</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}
</span><span class="cpp1-identifier">Hash Map </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#ed06</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">class</span><span class="cpp1-space"> hash_map</span><span class="cpp1-symbol">{
</span><span class="cpp1-reservedword">public</span><span class="cpp1-symbol">:
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">static</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> HASH_MAX </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0xffffff</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> N </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">8000000</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> cnt</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">HASH_MAX </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> data z</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> getHash</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> key</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">key </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> key </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">3</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> key </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> HASH_MAX</span><span class="cpp1-symbol">;}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> clear</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> cnt </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">--</span><span class="cpp1-identifier">cnt</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">z</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">cnt</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">hash</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;}

</span><span class="cpp1-space">	data </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> find</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> key</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> inserted</span><span class="cpp1-symbol">){
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> getHash</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">key</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">z</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">key </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> key</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> z </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">inserted</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> NULL</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		z</span><span class="cpp1-symbol">[++</span><span class="cpp1-identifier">cnt</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> data</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">key</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> next</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">cnt</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> first</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> cnt</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> z </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> cnt</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
};
</span><span class="cpp1-illegalchar">快速 Fourier 变换 </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">Fast Fourier Transform</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#ed07</span><span class="cpp1-symbol">]:

</span><span class="cpp1-comment">// 'Fast Number Theory Transform' is in memos/12.html.
</span><span class="cpp1-reservedword">typedef</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">complex </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-reservedword">double</span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">;

</span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> rpoly_base </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> iv</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> C w2</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">];

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> init</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> N</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> t </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> min</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> lg2</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">21</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> angle </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> pi</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(*</span><span class="cpp1-identifier">w2 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">(</span><span class="cpp1-number">1</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> t</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> w2</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">polar</span><span class="cpp1-symbol">(</span><span class="cpp1-float">1.</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> angle </span><span class="cpp1-symbol">*=</span><span class="cpp1-space"> </span><span class="cpp1-float">.5</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">3</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> w2</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> w2</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> w2</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> FFT_init</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> len</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">l </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> len</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> iv </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">1.</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> DIF</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">C </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">a</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> len </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> C </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">o</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> R</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> len </span><span class="cpp1-symbol">&gt;&gt;=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> a</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> o </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> w2</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> a </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> len </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">o</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">k </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> k </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> len</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">					R </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">o </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">len</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">len</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">k </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> R</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">k </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> R</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> DIT</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">C </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">a</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> len </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> C </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">o</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> R</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> len </span><span class="cpp1-symbol">&lt;&lt;=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> a</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> o </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> w2</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> a </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> len </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">o</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">k </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> k </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> len</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">					R </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">k </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">len</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">len</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(*</span><span class="cpp1-identifier">k </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">len</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">o</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">k </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> R</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}

</span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> rpoly </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">using</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> rpoly_base</span><span class="cpp1-symbol">;

</span><span class="cpp1-space">	C B1</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> B2</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> B3</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> B4</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">];

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> mulf</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">a</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">b</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!(</span><span class="cpp1-identifier">A </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{*</span><span class="cpp1-identifier">c </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">a </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">b</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> FFT_init</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">lg2</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">A </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> A</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> B1</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">a</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]);</span><span class="cpp1-space"> memset</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B1 </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">4</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> B2</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">b</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]);</span><span class="cpp1-space"> memset</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B2 </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">4</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		DIF</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B1</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> DIF</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B2</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> B1</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*=</span><span class="cpp1-space"> B2</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">		DIT</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B1</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">reverse</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B1 </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B1 </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> B1</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">real</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> iv</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> muli</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">a</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">b</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!(</span><span class="cpp1-identifier">A </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{*</span><span class="cpp1-identifier">c </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll</span><span class="cpp1-symbol">)*</span><span class="cpp1-identifier">a </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">b </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> FFT_init</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">lg2</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">A </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> A</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> B1</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">a</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-number">32767</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> a</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">15</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> memset</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B1 </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">4</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> B2</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">b</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-number">32767</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">15</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> memset</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B2 </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">4</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		DIF</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B1</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> DIF</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B2</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">B3 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> B1</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">real</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">B2</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">B4 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> B1</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">imag</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">B2</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">k </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> k </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-number">2</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">--</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">				B3</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B1</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">conj</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B1</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]))</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B2</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">(</span><span class="cpp1-float">.5</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-float">0.</span><span class="cpp1-symbol">),
</span><span class="cpp1-space">				B4</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B1</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">conj</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B1</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]))</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B2</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">(</span><span class="cpp1-float">0.</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-float">.5</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		DIT</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B3</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> DIT</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B4</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">			c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B3</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">real</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> iv </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-float">.5</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll</span><span class="cpp1-symbol">((</span><span class="cpp1-identifier">B3</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">imag</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> B4</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">real</span><span class="cpp1-symbol">())</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> iv </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-float">.5</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">15</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B4</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">imag</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> iv </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-float">.5</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">30</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}
</span><span class="cpp1-identifier">Gauss 消元法 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#ed08</span><span class="cpp1-symbol">]:

</span><span class="cpp1-comment">// Gauss elimination with type 'double'
</span><span class="cpp1-reservedword">struct</span><span class="cpp1-space"> LnEqn</span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> sz</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> </span><span class="cpp1-symbol">**</span><span class="cpp1-identifier">m</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">b</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	LnEqn </span><span class="cpp1-symbol">():</span><span class="cpp1-space"> sz</span><span class="cpp1-symbol">(</span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">m </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> NULL</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> b </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> NULL</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> resize</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> size</span><span class="cpp1-symbol">){
</span><span class="cpp1-space">		sz </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> size</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> m </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">new</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*[</span><span class="cpp1-identifier">sz</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> sz</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">++){
</span><span class="cpp1-space">			m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">new</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">sz</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">			memset</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> sz </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">3</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">		b </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">new</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">sz</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">		memset</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">b</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> sz </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">3</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">~</span><span class="cpp1-identifier">LnEqn </span><span class="cpp1-symbol">(){
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> sz</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">++)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">delete</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]);</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">delete</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">b</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">delete</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">b</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> solve</span><span class="cpp1-symbol">(){
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> maxi</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> coe</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">k </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> k </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> sz</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">++){
</span><span class="cpp1-space">			maxi </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> k </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> sz</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">++)
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">fabs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> fabs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">maxi</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">]))
</span><span class="cpp1-space">					maxi </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">fabs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">maxi</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-float">1e-8</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">maxi </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">){
</span><span class="cpp1-space">				swap</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">maxi</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">]);
</span><span class="cpp1-space">				swap</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">b</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">maxi</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">]);
</span><span class="cpp1-space">			</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">			coe </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">1.0</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> sz</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">++)
</span><span class="cpp1-space">				m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*=</span><span class="cpp1-space"> coe</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">1.0</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			b</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*=</span><span class="cpp1-space"> coe</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> sz</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">++){
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">continue</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">				coe </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> sz</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">++)
</span><span class="cpp1-space">					m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-=</span><span class="cpp1-space"> coe </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">				m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">0.0</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">				b</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-=</span><span class="cpp1-space"> coe </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">			</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
};
</span><span class="cpp1-illegalchar">线性规划 </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">xₚ ≥ </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> bₚ ≥ </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#ed09</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> eps </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">1e-8</span><span class="cpp1-symbol">;

</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> E</span><span class="cpp1-symbol">];

</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">E</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">E</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">c </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-number">0</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> ans</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> E</span><span class="cpp1-symbol">];

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> pivot</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> toFree</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> toBasic</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> </span><span class="cpp1-comment">// basic(1,m) -&gt; free, free(1,n) -&gt; basic

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> pivot</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> r</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">){
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> coe </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">1.0</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">r</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	swap</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> r</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">]);
</span><span class="cpp1-space">	m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">r</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">1.0</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">		m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">r</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*=</span><span class="cpp1-space"> coe</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	b</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">r</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*=</span><span class="cpp1-space"> coe</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">){
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> r</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">continue</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		coe </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">0.0</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">			m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-=</span><span class="cpp1-space"> coe </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">r</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">		b</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-=</span><span class="cpp1-space"> coe </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">r</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}

</span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> simplex</span><span class="cpp1-symbol">(){
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> basic</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> free</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> G</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">){
</span><span class="cpp1-space">		basic </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> free </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> G </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> INFINITY</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-comment">// free (nonbasic) variable
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">free</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> free </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">free</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-comment">// basic variable
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">free</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> eps </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> G </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">free</span><span class="cpp1-symbol">]){
</span><span class="cpp1-space">				G </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">free</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> basic </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">basic</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> puts</span><span class="cpp1-symbol">(</span><span class="cpp1-string">&quot;Unbounded&quot;</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		pivot</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">basic</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> free</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}

</span><span class="cpp1-comment">// initialize :
</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">;
</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">[</span><span class="cpp1-number">0</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> eps</span><span class="cpp1-symbol">;

</span><span class="cpp1-comment">// output:
</span><span class="cpp1-reservedword">if</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">simplex</span><span class="cpp1-symbol">()){
</span><span class="cpp1-space">	printf</span><span class="cpp1-symbol">(</span><span class="cpp1-string">&quot;%.8lg\n&quot;</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-*</span><span class="cpp1-identifier">b</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> ans</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">id</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">]]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> printf</span><span class="cpp1-symbol">(</span><span class="cpp1-string">&quot;%.8lg%c&quot;</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> ans</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> </span><span class="cpp1-number">10</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-number">32</span><span class="cpp1-symbol">);
}
</span><span class="cpp1-identifier">Gauss 消元求行列式 </span><span class="cpp1-symbol">(</span><span class="cpp1-illegalchar">模意义</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#ed10</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> gauss</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> det </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> ll coe</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">static</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> mat</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!</span><span class="cpp1-identifier">m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">];</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> det </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> mod </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> det</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">swap</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]);
</span><span class="cpp1-space">		det </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ll</span><span class="cpp1-symbol">)</span><span class="cpp1-identifier">det </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		coe </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> PowerMod</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> mod </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> coe </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">k </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> k </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">coe </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> mod </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> coe </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> m</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">][</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> mod</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> det</span><span class="cpp1-symbol">;
}
</span><span class="cpp1-identifier">Nim 积 </span><span class="cpp1-symbol">(</span><span class="cpp1-number">32</span><span class="cpp1-symbol">/</span><span class="cpp1-number">64</span><span class="cpp1-space"> bit</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#ed11</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> nimbers </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">constexpr</span><span class="cpp1-space"> u32 n2f</span><span class="cpp1-symbol">[</span><span class="cpp1-number">16</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-hexadecimal">0x0001u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x8ff5u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x6cbfu</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0xa5beu</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x761au</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x8238u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x4f08u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x95acu</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0xf340u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x1336u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x7d5eu</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x86e7u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x3a47u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0xe796u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0xb7c3u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x0008u</span><span class="cpp1-symbol">},
</span><span class="cpp1-space">				  f2n</span><span class="cpp1-symbol">[</span><span class="cpp1-number">16</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-hexadecimal">0x0001u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x2827u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x392bu</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x8000u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x20fdu</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x4d1du</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0xde4au</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x0a17u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x3464u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0xe3a9u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x6d8du</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x34bcu</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0xa921u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0xa173u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x0ebcu</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x0e69u</span><span class="cpp1-symbol">};
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> u32 nimber2field</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u32 x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">u32 y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&amp;=</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">^=</span><span class="cpp1-space"> n2f</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">ctz</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)];</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> u32 field2nimber</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u32 x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">u32 y </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&amp;=</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">^=</span><span class="cpp1-space"> f2n</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">ctz</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)];</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> u32 __builtin_double</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u32 x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x8000u</span><span class="cpp1-space"> </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-hexadecimal">0x1681fu</span><span class="cpp1-symbol">);}

</span><span class="cpp1-space">	u16 ln</span><span class="cpp1-symbol">[</span><span class="cpp1-number">65536</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> exp</span><span class="cpp1-symbol">[</span><span class="cpp1-number">131075</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">Hexp </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> exp </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">3</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">H2exp </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> exp </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">6</span><span class="cpp1-symbol">;

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> init</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(*</span><span class="cpp1-identifier">exp </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">65535</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> exp</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> __builtin_double</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">exp</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">65535</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> exp</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> field2nimber</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">exp</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]),</span><span class="cpp1-space"> ln</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">exp</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		memcpy</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">exp </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">65535</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> exp</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">131070</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		memcpy</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">exp </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">131070</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> exp</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">10</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> u16 product</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u16 A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> u16 B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> B </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> exp</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">ln</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">A</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> ln</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">]]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> u16 H</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u16 A</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> Hexp</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">ln</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">A</span><span class="cpp1-symbol">]]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> u16 H2</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u16 A</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> H2exp</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">ln</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">A</span><span class="cpp1-symbol">]]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> u16 Hproduct</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u16 A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> u16 B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> B </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> Hexp</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">ln</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">A</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> ln</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">]]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> u32 product</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u32 A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> u32 B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		u16 a </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-number">65535</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> b </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> B </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-number">65535</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> c </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">16</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> d </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> B </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">16</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> e </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> product</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">a</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> u32</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">product</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u16</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">a </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> u16</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">b </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> d</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">16</span><span class="cpp1-space"> </span><span class="cpp1-symbol">|</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">Hproduct</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> d</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> u32 H</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u32 A</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		u16 a </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> </span><span class="cpp1-number">65535</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> b </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">16</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> H</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u16</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">a </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">16</span><span class="cpp1-space"> </span><span class="cpp1-symbol">|</span><span class="cpp1-space"> H2</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">b</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> u64 product</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u64 A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> u64 B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		u32 a </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> UINT_MAX</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> b </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> B </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> UINT_MAX</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> c </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">32</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> d </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> B </span><span class="cpp1-symbol">&gt;&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">32</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> e </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> product</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">a</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> u64</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">product</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">a </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> b </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> d</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">32</span><span class="cpp1-space"> </span><span class="cpp1-symbol">|</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">H</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">product</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> d</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> e</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}

</span></span>
</code></pre>
</body>
</html>