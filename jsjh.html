<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>计算几何.html</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="SynEdit HTML exporter" />
<style type="text/css">
<!--
body { color: #000000; background-color: #FFFFFF; }
.cpp1-assembler { color: #0000FF; }
.cpp1-character { color: #000000; }
.cpp1-comment { color: #0078D7; font-style: italic; }
.cpp1-float { color: #800080; }
.cpp1-hexadecimal { color: #800080; }
.cpp1-identifier { color: #000000; }
.cpp1-illegalchar { color: #000000; }
.cpp1-number { color: #800080; }
.cpp1-octal { color: #800080; }
.cpp1-preprocessor { color: #008000; }
.cpp1-reservedword { color: #000000; font-weight: bold; }
.cpp1-space { background-color: #FFFFFF; color: #000000; }
.cpp1-string { color: #0000FF; font-weight: bold; }
.cpp1-symbol { color: #FF0000; font-weight: bold; }
-->
</style>
</head>
<body>
<pre>
<code><span style="font: 21pt Consolas;"><span class="cpp1-illegalchar">二维向量</span><span class="cpp1-symbol">/</span><span class="cpp1-illegalchar">点、计算几何基础 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#cg01</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> eps </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">1e-8</span><span class="cpp1-symbol">;

</span><span class="cpp1-preprocessor">#define lt(x, y) ((x) &lt; (y) - eps)
#define gt(x, y) ((x) &gt; (y) + eps)
#define le(x, y) ((x) &lt;= (y) + eps)
#define ge(x, y) ((x) &gt;= (y) - eps)
#define eq(x, y) (le(x, y) &amp;&amp; ge(x, y))
#define dot(x, y, z) (((y) - (x)) * ((z) - (x)))
#define cross(x, y, z) (((y) - (x)) ^ ((z) - (x)))

</span><span class="cpp1-reservedword">struct</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	vec2 </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> x0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">0.0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> y0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">0.0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{}
</span><span class="cpp1-space">	vec2 </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> read</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">scanf</span><span class="cpp1-symbol">(</span><span class="cpp1-string">&quot;%lf%lf&quot;</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec2 </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> vec2</span><span class="cpp1-symbol">(-</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec2 </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> vec2</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec2 </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> vec2</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec2 </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> vec2</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec2 </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-reservedword">this</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-float">1.0</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> norm2</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> norm</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> sqrt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> lt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> le</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> lt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> eq</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> eq</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> lt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> lt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> lt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> gt</span><span class="cpp1-symbol">(*</span><span class="cpp1-reservedword">this</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> ge</span><span class="cpp1-symbol">(*</span><span class="cpp1-reservedword">this</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> ge</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> lt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec2 trans</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> a11</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> a12</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> a21</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> a22</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> vec2</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> a11 </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> a12</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> a21 </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> a22</span><span class="cpp1-symbol">);}
};

</span><span class="cpp1-comment">/*
operator * : Dot product
operator ^ : Cross product
norm2() : |v|^2 = v.v
norm() : |v| = sqrt(v.v)
operator &lt; : Two-key compare
operator &lt;&lt; : Polar angle compare
trans : Transition with a 2x2 matrix
*/
</span><span class="cpp1-illegalchar">直线及其函数 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#cg02</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">struct</span><span class="cpp1-space"> line </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-comment">// Ax + By + C = 0, &gt; 0 if it represents halfplane.
</span><span class="cpp1-space">	line </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> A0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">0.0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> B0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">0.0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> C0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">0.0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> A</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">A0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">C0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{}
</span><span class="cpp1-space">	line </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> A</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{}</span><span class="cpp1-space"> </span><span class="cpp1-comment">// left &gt; 0
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec2 normVec</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> vec2</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> norm2</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> B </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> B </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">;}
};

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec2 intersection</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> line u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> line v</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> vec2</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">B </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">C </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">C </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">C </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">A </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">A </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">C</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">A </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">B </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">B </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">A</span><span class="cpp1-symbol">);}

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> parallel</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> line u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> line v</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> p </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">();</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> eq</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">);}

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> perpendicular</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> line u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> line v</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> p </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">();</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> eq</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">);}

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> sameDir</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> line u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> line v</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> parallel</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> gt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">(),</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">);}

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> line bisector</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 v</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> line</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-float">0.5</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">()));}

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> dis2</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 P</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> line l</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">();}

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec2 projection</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 P</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> line l</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> P </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">l</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">());}

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec2 symmetry</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 P</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> line l</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> P </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-number">2</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">());}
</span><span class="cpp1-illegalchar">多边形操作 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#cg03</span><span class="cpp1-symbol">]:

</span><span class="cpp1-comment">// Relation of 3 points. (2 inside, 1 outside, 0 not collinear)
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> collinear</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 P</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> p </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> cross</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> eq</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> le</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">dot</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;}

</span><span class="cpp1-comment">// Perimeter of a polygon
</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> perimeter</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> ret </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">).</span><span class="cpp1-identifier">norm</span><span class="cpp1-symbol">();
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> ret </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> poly</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]).</span><span class="cpp1-identifier">norm</span><span class="cpp1-symbol">();
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> ret</span><span class="cpp1-symbol">;
}

</span><span class="cpp1-comment">// Directed area of a polygon (positive if CCW)
</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> area</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> ret </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> poly</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> ret </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> poly</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> poly</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> ret </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-float">0.5</span><span class="cpp1-symbol">;
}

</span><span class="cpp1-comment">// Point in polygon (2 on boundary, 1 inside, 0 outside)
</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> contain</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 P</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> in </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">r </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> poly </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> r </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> poly</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">collinear</span><span class="cpp1-symbol">(*</span><span class="cpp1-identifier">r</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> P</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		gt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">r</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> poly</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> poly</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> r</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> r</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> poly</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ge</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> lt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">continue</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		in </span><span class="cpp1-symbol">^=</span><span class="cpp1-space"> gt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">cross</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> in</span><span class="cpp1-symbol">;
}
</span><span class="cpp1-illegalchar">平面凸包 </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">Graham Scan</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#cg04</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> graham</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">dest</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">ret </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> dest</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">iter_swap</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">min_element</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> p </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">));
</span><span class="cpp1-space">	std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">sort</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> p </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> r </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> cross</span><span class="cpp1-symbol">(*</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> gt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">r</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ge</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">r</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> lt</span><span class="cpp1-symbol">((</span><span class="cpp1-identifier">A </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">).</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">(),</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">).</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">()));});
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">ret</span><span class="cpp1-symbol">++</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">ret</span><span class="cpp1-symbol">++</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">++])
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> ret </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> dest </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> ge</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">cross</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ret</span><span class="cpp1-symbol">[-</span><span class="cpp1-number">2</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> ret</span><span class="cpp1-symbol">[-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">]),</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> </span><span class="cpp1-symbol">--</span><span class="cpp1-identifier">ret</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">ret </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> ret </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> dest</span><span class="cpp1-symbol">;
}
</span><span class="cpp1-illegalchar">旋转卡壳求凸集直径 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#cg05</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> convDiameter</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> l </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">min_element</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> poly </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> poly</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> r </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">max_element</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> poly </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> poly</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> r</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> diam </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">l</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> poly</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">r</span><span class="cpp1-symbol">]).</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">();
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">do</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ge</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">[(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> poly</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> poly</span><span class="cpp1-symbol">[(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> poly</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		up</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">diam</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> poly</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]).</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">());
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">while</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> l </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> r</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> diam</span><span class="cpp1-symbol">;
}
</span><span class="cpp1-illegalchar">三角形外心 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-space"> 最小圆覆盖 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#cg06</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec2 circumCenter</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 C</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	vec2 a </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> B </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> b </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> C </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> AO</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> det </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">0.5</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">a </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> na </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> a</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">(),</span><span class="cpp1-space"> nb </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">();
</span><span class="cpp1-space">	AO </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> vec2</span><span class="cpp1-symbol">((</span><span class="cpp1-identifier">na </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> nb </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> a</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> det</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">nb </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> a</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> na </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> b</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> det</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> AO</span><span class="cpp1-symbol">;
}

</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> minCircleCover</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">ret </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> NULL</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> r2 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">0.0</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">random_shuffle</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> p </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">));
</span><span class="cpp1-space">	vec2 C </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">gt</span><span class="cpp1-symbol">((</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">).</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">(),</span><span class="cpp1-space"> r2</span><span class="cpp1-symbol">))
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">C </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> r2 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">gt</span><span class="cpp1-symbol">((</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">).</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">(),</span><span class="cpp1-space"> r2</span><span class="cpp1-symbol">))
</span><span class="cpp1-space">					</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">C </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-float">0.5</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> r2 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">).</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">(),</span><span class="cpp1-space"> k </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> k </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">						</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">gt</span><span class="cpp1-symbol">((</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">).</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">(),</span><span class="cpp1-space"> r2</span><span class="cpp1-symbol">))
</span><span class="cpp1-space">							C </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> circumCenter</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">]),</span><span class="cpp1-space"> r2 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">k</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">).</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">();
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> ret </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">ret </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> C </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> r2</span><span class="cpp1-symbol">;
}
</span><span class="cpp1-illegalchar">半平面交 </span><span class="cpp1-symbol">(</span><span class="cpp1-illegalchar">平行处理版</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#cg07</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> HPIcmp</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> line u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> line v</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> sameDir</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> gt</span><span class="cpp1-symbol">((</span><span class="cpp1-identifier">fabs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">A</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> fabs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">C</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">fabs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">A</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> fabs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">C</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;&lt;</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">();}

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> geStraight</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> lt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">A </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> le</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">A </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> lt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">A </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">);}

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> para_nega_test</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> line u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> line v</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> parallel</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> lt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">(),</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">fabs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">A</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> fabs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">C </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">fabs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">A</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> fabs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">C </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-float">7e-14</span><span class="cpp1-symbol">;
}

</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> HPI</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> line </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">l</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">*&amp;</span><span class="cpp1-identifier">ret</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-space"> </span><span class="cpp1-comment">// -1 : Unbounded, -2 : Infeasible
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> h </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> t </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">5</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">sort</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">l</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> l </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> HPIcmp</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	n </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">unique</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">l</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> l </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> sameDir</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">up</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">!</span><span class="cpp1-identifier">geStraight</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">l</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">(),</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">());</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">para_nega_test</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">l</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">j</span><span class="cpp1-symbol">]))</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">2</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">&lt;=</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-space"> </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> geStraight</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">l</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">n </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">(),</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">()))</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">geStraight</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">l</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">t</span><span class="cpp1-symbol">]].</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">(),</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">()))</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> h </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> t </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> le</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">l</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">](</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">t </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]),</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> </span><span class="cpp1-symbol">--</span><span class="cpp1-identifier">t</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> h </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> t </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> le</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">l</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">](</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">h</span><span class="cpp1-symbol">]),</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">h</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		que</span><span class="cpp1-symbol">[++</span><span class="cpp1-identifier">t</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> h </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> t </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> poly</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">t </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> intersection</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">l</span><span class="cpp1-symbol">[</span><span class="cpp1-space"> que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">t </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">],</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">[</span><span class="cpp1-space"> que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">t</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(;</span><span class="cpp1-space"> h </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> t </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> le</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">l</span><span class="cpp1-symbol">[</span><span class="cpp1-space"> que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">h</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">](</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">t </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">]),</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> </span><span class="cpp1-symbol">--</span><span class="cpp1-identifier">t</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> h </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> t </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">2</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">poly</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">t</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> intersection</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">l</span><span class="cpp1-symbol">[</span><span class="cpp1-space"> que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">t</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">],</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">[</span><span class="cpp1-space"> que</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">h</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">]),</span><span class="cpp1-space"> ret </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> poly </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> h</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> t </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> h </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">);
}
</span><span class="cpp1-illegalchar">平面上的圆几何 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#cg08</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> pi </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> M_PI</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> pi2 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> pi </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-float">2.</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> pi_2 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> M_PI_2</span><span class="cpp1-symbol">;

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> angle</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 v</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> atan2</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> u </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">);}

</span><span class="cpp1-comment">// intersection of circle and line
</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> intersection</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> r2</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 O</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> line l</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> vec2 </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">ret</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> d2 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> dis2</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">O</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> vec2 j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">normVec</span><span class="cpp1-symbol">();
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">gt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">d2</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> r2</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">0</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> vec2</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">INFINITY</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> INFINITY</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ge</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">d2</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> r2</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">0</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> projection</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">O</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">le</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">d2</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> sqrt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">r2 </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">());
</span><span class="cpp1-space">		ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">0</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> O </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">trans</span><span class="cpp1-symbol">(</span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> O </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">trans</span><span class="cpp1-symbol">(</span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">else</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> T </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> copysign</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">sqrt</span><span class="cpp1-symbol">((</span><span class="cpp1-identifier">r2 </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> d2</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> d2</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">O</span><span class="cpp1-symbol">));</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> j </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(-</span><span class="cpp1-identifier">l</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">O</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">());
</span><span class="cpp1-space">		ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">0</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> O </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">trans</span><span class="cpp1-symbol">(</span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> T</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-identifier">T</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">		ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> O </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> j</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">trans</span><span class="cpp1-symbol">(</span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-identifier">T</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> T</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">;
}

</span><span class="cpp1-comment">// area of intersection(x^2 + y^2 = r^2, triangle OBC)
</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> interArea</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> r2</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 C</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">eq</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	vec2 is</span><span class="cpp1-symbol">[</span><span class="cpp1-number">2</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!</span><span class="cpp1-identifier">intersection</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">r2</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> vec2</span><span class="cpp1-symbol">(),</span><span class="cpp1-space"> line</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> is</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-float">0.5</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> r2 </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> angle</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> b </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> gt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">(),</span><span class="cpp1-space"> r2</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> c </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> gt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">C</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">(),</span><span class="cpp1-space"> r2</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">b </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> c</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-float">0.5</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">lt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">dot</span><span class="cpp1-symbol">(*</span><span class="cpp1-identifier">is</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> r2 </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">angle</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">is</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> angle</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">is</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">is</span><span class="cpp1-symbol">[</span><span class="cpp1-number">0</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> is</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> r2 </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> angle</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">));
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">else</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">b</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-float">0.5</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">r2 </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> angle</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">is</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(*</span><span class="cpp1-identifier">is </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">));
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">else</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">c</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-float">0.5</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">((</span><span class="cpp1-identifier">B </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> is</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">])</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> r2 </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> angle</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">is</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">));
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">else</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-float">0.5</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">);
}

</span><span class="cpp1-comment">// tangents to circle((0, 0), r) through P
</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> tangent</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> r</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 P</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> line </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">ret</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> Q </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> r </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> r</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">lt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">Q</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">0</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> line</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">INFINITY</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> INFINITY</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> INFINITY</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">le</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">Q</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">0</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> line</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">()),</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	Q </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> sqrt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">Q</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> r</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">0</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> line</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> Q </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> Q </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">());
</span><span class="cpp1-space">	ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> line</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> Q </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> Q </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">());
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">;
}

</span><span class="cpp1-comment">// tangets to circle(O, r) through P
</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> tangent</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> r</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 O</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec2 P</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> line </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">ret</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> R </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> tangent</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">r</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> P </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> O</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> ret</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">R</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">		ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">0</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">C </span><span class="cpp1-symbol">-=</span><span class="cpp1-space"> ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">0</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">A </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> O</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">0</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">B </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> O</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,
</span><span class="cpp1-space">		ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">C </span><span class="cpp1-symbol">-=</span><span class="cpp1-space"> ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">A </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> O</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> ret</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">B </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> O</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> R</span><span class="cpp1-symbol">;
}
</span><span class="cpp1-illegalchar">三维计算几何基础 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#cg09</span><span class="cpp1-symbol">]:

</span><span class="cpp1-preprocessor">#define triple(x, y, z) ((x) * ((y) ^ (z)))

</span><span class="cpp1-reservedword">struct</span><span class="cpp1-space"> vec3 </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> z</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	vec3 </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> x0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> y0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> z0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> x</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> y</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> z</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">z0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{}
</span><span class="cpp1-space">	vec3 </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> read</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">scanf</span><span class="cpp1-symbol">(</span><span class="cpp1-string">&quot;%lf%lf%lf&quot;</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">z</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec3 </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> vec3</span><span class="cpp1-symbol">(-</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-identifier">z</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec3 </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec3 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> vec3</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> z </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">z</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec3 </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec3 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> vec3</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> z </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">z</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec3 </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> vec3</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec3 </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-reservedword">this</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-float">1.0</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> k</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec3 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> z </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">z</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec3 </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec3 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> vec3</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">z </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> z </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> z </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">z</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> norm2</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> z </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> z</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> norm</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> sqrt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> x </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> y </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> z </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> z</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec3 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> lt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> le</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">lt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> le</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> lt</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">z</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">z</span><span class="cpp1-symbol">));}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec3 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">B</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> eq</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> eq</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> eq</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">z</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">z</span><span class="cpp1-symbol">);}
};

</span><span class="cpp1-comment">// Positive if Right-hand rule
</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> volume</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec3 A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec3 B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec3 C</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec3 D</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> triple</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> C </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> D </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> A</span><span class="cpp1-symbol">);}

</span><span class="cpp1-reservedword">struct</span><span class="cpp1-space"> line3 </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	vec3 P</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> t</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	line3 </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">vec3 _P </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> vec3</span><span class="cpp1-symbol">(),</span><span class="cpp1-space"> vec3 _t </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> vec3</span><span class="cpp1-symbol">())</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> P</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">_P</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> t</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">_t</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{}
};

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> dis2</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec3 P</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> line3 l</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">((</span><span class="cpp1-identifier">P </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">t</span><span class="cpp1-symbol">).</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> l</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">t</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">();}

</span><span class="cpp1-reservedword">struct</span><span class="cpp1-space"> plane </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> D</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-comment">// Ax + By + Cz + D = 0
</span><span class="cpp1-space">	plane </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> A0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">0.0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> B0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">0.0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> C0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">0.0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> D0 </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-float">0.0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> A</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">A0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">B0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">C0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> D</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">D0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{}
</span><span class="cpp1-space">	plane </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec3 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec3 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec3 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">w</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">vec3 t </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">^</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">w </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> t</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> t</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> C </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> t</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">z</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> D </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-identifier">triple</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> w</span><span class="cpp1-symbol">);}</span><span class="cpp1-space"> </span><span class="cpp1-comment">// &gt; 0 if it follows Right-hand rule
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec3 normVec</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> vec3</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">);}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> norm2</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> B </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> B </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> C </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">;}
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">operator</span><span class="cpp1-space"> </span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec3 </span><span class="cpp1-symbol">&amp;</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">x </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> B </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">y </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> C </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> P</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">z </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> D</span><span class="cpp1-symbol">;}
};

</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> dis2</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> vec3 P</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> plane F</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> F</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> F</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">P</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> F</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">norm2</span><span class="cpp1-symbol">();}
</span><span class="cpp1-illegalchar">三维凸包 </span><span class="cpp1-symbol">(</span><span class="cpp1-illegalchar">卷包裹法</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#cg10</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> CH3D </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">typedef</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">pair </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-reservedword">int</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> pr</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">typedef</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">set </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">pr</span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> set</span><span class="cpp1-symbol">;

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">struct</span><span class="cpp1-space"> triangle </span><span class="cpp1-symbol">{</span><span class="cpp1-identifier">vec3 A</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> B</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> C</span><span class="cpp1-symbol">;}</span><span class="cpp1-space"> tr</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">];

</span><span class="cpp1-space">	vec3 p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> q</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> r</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">N</span><span class="cpp1-symbol">];
</span><span class="cpp1-space">	set E</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> cnt</span><span class="cpp1-symbol">;

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">inline</span><span class="cpp1-space"> vec3 randvec3</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> vec3</span><span class="cpp1-symbol">((</span><span class="cpp1-reservedword">double</span><span class="cpp1-symbol">)</span><span class="cpp1-identifier">rand</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> RAND_MAX</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">double</span><span class="cpp1-symbol">)</span><span class="cpp1-identifier">rand</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> RAND_MAX</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">double</span><span class="cpp1-symbol">)</span><span class="cpp1-identifier">rand</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> RAND_MAX</span><span class="cpp1-symbol">);}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> wrap</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">E</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">find</span><span class="cpp1-symbol">({</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">})</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> E</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">end</span><span class="cpp1-symbol">())</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> w </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">				</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> u </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">!=</span><span class="cpp1-space"> v </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(!~</span><span class="cpp1-identifier">w </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> ge</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">volume</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">q</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">w</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> q</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> q</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> q</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]),</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)))</span><span class="cpp1-space"> w </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(~</span><span class="cpp1-identifier">w</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">				tr</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">cnt</span><span class="cpp1-symbol">++]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">triangle</span><span class="cpp1-symbol">){</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">w</span><span class="cpp1-symbol">]};
</span><span class="cpp1-space">				E</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">emplace</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> E</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">emplace</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">v</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> w</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> E</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">emplace</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">w</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> u</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">				wrap</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">w</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> v</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> wrap</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> w</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">			</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">		</span><span class="cpp1-symbol">}
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}

</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> main</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> _n</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> vec3 </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">_p</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> i</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		n </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> _n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> cnt </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> E</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">clear</span><span class="cpp1-symbol">();
</span><span class="cpp1-space">		memcpy</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> _p</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> n </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">sizeof</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">vec3</span><span class="cpp1-symbol">));
</span><span class="cpp1-space">		std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">iter_swap</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">min_element</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> p </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">));
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> q</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> randvec3</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-float">1e-6</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">		</span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> i </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> n</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ge</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">cross</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">q</span><span class="cpp1-symbol">[</span><span class="cpp1-number">0</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> q</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> q</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">]).</span><span class="cpp1-identifier">z</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">))</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">swap</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">p</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> p</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]),</span><span class="cpp1-space"> std</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">swap</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">q</span><span class="cpp1-symbol">[</span><span class="cpp1-number">1</span><span class="cpp1-symbol">],</span><span class="cpp1-space"> q</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">]);
</span><span class="cpp1-space">		wrap</span><span class="cpp1-symbol">(</span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}
}
</span><span class="cpp1-illegalchar">自适应 Simpson 积分 </span><span class="cpp1-symbol">[</span><span class="cpp1-illegalchar">#cg11</span><span class="cpp1-symbol">]:

</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> Simpson</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> L</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> M</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> R</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> fL</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> fM</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> fR</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> eps</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> LM </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">L </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> M</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-float">0.5</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> fLM </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">LM</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> MR </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">M </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> R</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-float">0.5</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> fMR </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> f</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">MR</span><span class="cpp1-symbol">);
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">double</span><span class="cpp1-space"> A </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">fL </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> fM </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-float">4.0</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> fR</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">R </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> L</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> sixth</span><span class="cpp1-symbol">,
</span><span class="cpp1-space">		   AL </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">fL </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> fLM </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-float">4.0</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> fM</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">M </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> L</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> sixth</span><span class="cpp1-symbol">,
</span><span class="cpp1-space">		   AR </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">fM </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> fMR </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-float">4.0</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> fR</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">R </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> M</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> sixth</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">fabs</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">AL </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> AR </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> A</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> eps</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-float">2.0</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">AL </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> AR</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> A</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> third</span><span class="cpp1-symbol">;
</span><span class="cpp1-space">	</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> Simpson</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">L</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> LM</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> M</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> fL</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> fLM</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> fM</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> eps </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-float">0.6</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> Simpson</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">M</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> MR</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> R</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> fM</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> fMR</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> fR</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> eps </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-float">0.6</span><span class="cpp1-symbol">);
}
</span></span>
</code></pre>
</body>
</html>